using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;
using System.Collections.Generic;
using System.Linq;

namespace Manage_Receive_Issues_Goods.Controllers
{
    [Route("api/[controller]")]
    [ApiController]
    public class ResourcesController : ControllerBase
    {
        // GET: api/Resources
        [HttpGet]
        public IActionResult GetResources()
        {
            var resources = new List<dynamic>();

            // Example: Fetch plans from a database or other data source
            var plans = GetPlans();

            foreach (var plan in plans)
            {
                resources.Add(new
                {
                    id = $"{plan.SupplierCode}_Plan",
                    title = "Plan",
                    eventColor = "#1E2B37",
                    order = plan.Order,
                    cssClass = ""
                });

                resources.Add(new
                {
                    id = $"{plan.SupplierCode}_Actual",
                    title = "Actual",
                    eventColor = "#3E7D3E",
                    order = plan.Order + 1,
                    cssClass = "gray-background"
                });
            }

            // Return resources ordered by order
            return Ok(resources.OrderBy(r => r.order));
        }

        private IEnumerable<Plan> GetPlans()
        {
            // This method should fetch data from your data source
            // For demonstration, returning a static list
            return new List<Plan>
            {
                new Plan { SupplierName = "SupplierA", SupplierCode = "A001", Order = 1 },
                new Plan { SupplierName = "SupplierB", SupplierCode = "B002", Order = 3 },
                // Add more plans as needed
            };
        }

        private class Plan
        {
            public string SupplierName { get; set; }
            public string SupplierCode { get; set; }
            public int Order { get; set; }
        }
    }
}
